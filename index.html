<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Matrix Chat ‚Äî –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs" defer></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen" x-data="chatApp()">

    <!-- –í—ñ–∫–Ω–æ –ª–æ–≥—ñ–Ω—É -->
    <template x-if="!accessToken">
        <div class="bg-white p-8 rounded-2xl shadow-lg w-[420px]">
            <h2 class="text-2xl font-bold mb-5 text-center text-gray-800">–í—Ö—ñ–¥ –¥–æ Matrix</h2>

            <input x-model="username" placeholder="–Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞"
                   class="border border-gray-300 p-3 w-full mb-3 rounded-lg focus:ring-2 focus:ring-blue-400 outline-none" />
            <input x-model="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å"
                   class="border border-gray-300 p-3 w-full mb-4 rounded-lg focus:ring-2 focus:ring-blue-400 outline-none" />
            <button @click="login()"
                    class="bg-blue-600 hover:bg-blue-700 text-white p-3 w-full rounded-lg font-semibold transition">
                –£–≤—ñ–π—Ç–∏
            </button>

            <p x-text="error" class="text-red-600 mt-3 text-center font-medium"></p>
        </div>
    </template>

    <!-- –ü–∞–Ω–µ–ª—å –ø—ñ—Å–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó -->
    <template x-if="accessToken">
        <div class="bg-white p-8 rounded-2xl shadow-2xl w-[700px] flex flex-col space-y-6">
            <h1 class="text-2xl font-bold text-gray-800 text-center">
                ‚úÖ –í–∏ —É—Å–ø—ñ—à–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑—É–≤–∞–ª–∏—Å—å!
            </h1>

            <!-- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ -->
            <div class="bg-gray-100 p-4 rounded-lg text-gray-700">
                <p><span class="font-bold">–í–∞—à Matrix ID:</span> <span x-text="userId ? userId : '–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...'"></span></p>
                <p><span class="font-bold">–¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É:</span> <span x-text="accessToken.slice(0, 15) + '...'" class="text-sm text-gray-500"></span></p>
            </div>

            <!-- –†–æ–∑–¥—ñ–ª —Ä–µ–∑—é–º–µ -->
            <div class="bg-blue-50 p-5 rounded-lg border border-blue-200">
                <h2 class="text-xl font-bold mb-3 text-blue-700">üë§ –†–µ–∑—é–º–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</h2>
                <ul class="space-y-1 text-gray-800">
                    <li><span class="font-semibold">–Ü–º'—è:</span> –í–æ–ª–æ–¥–∏–º–∏—Ä</li>
                    <li><span class="font-semibold">–ü—Ä—ñ–∑–≤–∏—â–µ:</span> Sh </li>
                    <li><span class="font-semibold">–†—ñ–∫ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è:</span> 1992</li>
                    <li><span class="font-semibold">–ú—ñ—Å—Ü–µ –Ω–∞–≤—á–∞–Ω–Ω—è:</span> KPI</li>
                    <li><span class="font-semibold">–°–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ—Å—Ç—å:</span> –ö–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ –Ω–∞—É–∫–∏</li>
                </ul>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ –≤–∏—Ö–æ–¥—É -->
            <button @click="logout()" class="bg-red-600 hover:bg-red-700 text-white p-3 rounded-lg font-semibold transition">
                –í–∏–π—Ç–∏
            </button>
        </div>
    </template>

    <script>
        function chatApp() {
            return {
                username: '',
                password: '',
                accessToken: '',
                userId: '',
                error: '',

                async login() {
                    this.error = '';
                    try {
                        const res = await fetch('https://matrix.org/_matrix/client/r0/login', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                type: 'm.login.password',
                                user: this.username,
                                password: this.password
                            })
                        });

                        const data = await res.json();

                        if (data.access_token) {
                            this.accessToken = data.access_token;
                            this.userId = data.user_id;
                        } else {
                            // –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                            this.error = '‚ùå –ù–µ–≤—ñ—Ä–Ω–µ —ñ–º‚Äô—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ –ø–∞—Ä–æ–ª—å.';
                        }
                    } catch (e) {
                        this.error = '‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –≤—Ö–æ–¥—É. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º.';
                        console.error(e);
                    }
                },

                logout() {
                    this.accessToken = '';
                    this.userId = '';
                    this.username = '';
                    this.password = '';
                    this.error = '';
                }
            }
        }
    </script>
</body>
</html>